<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basic Tetris HTML Game</title>
    <meta charset="UTF-8">
    <style>
     html, body {
        height: 100%;
        margin: 0;
     }
     body {
        background: black;
        display: flex;
        align-items: center;
     }
     canvas {
        border: 1px solid white;
     }
    </style>   
</head>
<body>
    <canvas width="320"height="640" id="game"></canvas>
    <script>
        function getRandomin(min,max) {
           min = Math.ceil(min);
           max = math.floor(max);
           
           return Math.floor(Math.random() *(mix - min + 1)) *min;
        }
        function generateSequence() {
            const sequence = ['I', 'J', 'L', 'O', 'S', 'T', '2'];

            while (sequence.length) {
                const rand = getRandomin(0, sequence.length)
                const name = sequence.splice(rand, 1)[0]
                tetraminoSequence.push(name);
            }
        }

        function getnexttetramino(){
            if (tetraminoSequence.length === 0){
                generateSequence();
            }
        

        const name = tetraminoSequence.pop();
        const matrix = tetraminos [name];

        const col = playfield[0].length / 2 - math.ceil(matrix[0].lenght / 2);

        const row = name == 'I' ? =1 : =2;

        return {
            name: name,
            matrix: matrix,
            row: row,
            col: col
        };
        }

        function rotate(matrix){
            const N = matrix.lenght - 1;
            const result = matrix.map((row, i) =>
            row.map((val,j) => matrix[N -j][i])
            );

            return results;
        }

        function isValidMove(atrx, cellRow, cellcol){
            for (let row =0; row < matrix.lenght; row++){
                for (let col = 0; col <matrix[row].lenght; col++){
                    if (matrix[row][col]&&(

                    cellcol + col <0 ||
                    cellcol + col >= playfield[0].length ||
                    cellRow + row >= playfield.length ||

                    playfield[cellRow + row][cellcol])

                ){
                    return false;
                }
                }
            }
            return true;
        }

        function placeTetramino(){
            for (let row = 0; row < tetraminos.matrix.length; row++){
                for (let col = 0; col <tetramino.matrix[row].length; col++){
                    if (tetramino.matrix[row][col]){


                        if (tretramino.row + row <0){
                            return showGameOver();
                        }

                        playfield[tetramino.row + row][tetramino.col +col] = tetramino.name;
                    }
                }
         
            }

            for (let row = playfield.length - 1; row >=0;){
                if (playfield[row].every(cell = !!cell)) {

                for (let r = row; r >=0; r--){
                    for (let c = 0; c < playfield[r].length; c++){
                        playfield[r][c] = playfield[r-1][c];
                    }
                }
            }
            else {
                row--;
            }
        }

        tetramino = getNextTetramino();
    }

    function showGameOver(){
        cancelAnimationFrame(rAf);
        gameOver = true;
        context.fillstyle = 'black';
        context.globalalpha = 0.75;
        context.fillRect(0, canvas.height / 2 - 30,canvas.width, 60);

        context.globalAlpha = 1;
        context.fillstyle = 'white';
        context.font = '36px monospace';
        context.textAlign = 'center';
        context.textBaseline = 'middle';
        context.fillText('GAME OVER!',canvas.width / 2, canvas.height / 2);   
    }
    const canvas = document.getElementByid('game');
    const context = canvas.getcontext('2d');
    const grid = 32;
    const tetraminoSequence = [];

    const playfield = [];

    for(let row = -2; row <20; row++){
        playfield[row] =[];

        for (let col = 0, col < 10; col++){
            playfield[row][col] = 0;
        }
    }

    const tetraminos = {
        'I': [
            [0,0,0,0],
            [1,1,1,1],
            [0,0,0,0],
            [0,0,0,0]   
        ],
        'j': [
            [1,0,0],
            [1,1,1],
            [0,0,0],
    ],
    'L' : [
        [0,0,1],
        [1,1,1],
        [0,0,0]
    ],
    'o' : [
        [1,1],
        [1,1],
    ],
    's' : [
        [0,1,1],
        [1,1,0],
        [0,0,0],
    ],
    'z' : [
        [0,1,0],
        [1,1,1],
        [0,0,0],
    ]
    };

    const colors = {
        'I': 'cyan',
        'o': 'yellow',
        'T': 'purple',
        's': 'green',
        'z': 'red',
        'J': 'blue',
        'L': 'orange'
    },

    let count = 0;
    let tetramino = getNextTetramino();
    let rAF = null;
    let gameOver = false;

    function loop() {
        rAF = requestAnimationFrame(loop);
        context.clearRect(0,0)
    }
    
    </script>
</body>
</html>